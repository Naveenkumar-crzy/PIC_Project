#include <xc.h>
#define _XTAL_FREQ 20000000
#define RS PORTCbits.RC0
#define RW PORTCbits.RC1
#define EN PORTCbits.RC2
#define LIGHT PORTCbits.RC5
#define OFF PORTDbits.RD0
#define AUTO PORTDbits.RD1
#define ON PORTDbits.RD2
#define S1 PORTDbits.RD3
#define S2 PORTDbits.RD4
#define S3 PORTDbits.RD5
#define S4 PORTDbits.RD6



void lcd_data (unsigned char data)
{
    PORTB = data;
   RS = 1;
   RW = 0;
   EN = 1;
   __delay_ms(5);
   EN = 0 ;
   
}
void lcd_cmd (unsigned char cmd)
{
    PORTB = cmd;
    RS = 0;
    RW = 0;
    EN = 1;
      __delay_ms(5);
   EN = 0 ;  
}
void lcd_string (unsigned char *str,unsigned char num)
{
    for (unsigned int i =0;i <num;i++)
    {
        lcd_data(str[i]);
    }}
    void lcd_init()
    {
        lcd_cmd(0x38);
        lcd_cmd(0x06);
        lcd_cmd(0x0C);
        lcd_cmd(0x01);
    }
    void AUTO_MODE(){
    
        if (S1== 1 ||S2== 1 ||S3== 1 ||S4== 1 )
        {
             LIGHT  = 1;  
             lcd_cmd(0x83);   
           lcd_string ("DOOR OPEN",9);
    lcd_cmd(0xC3);
     lcd_string ("LIGHT ON",8);
    
        }
        else 
        {
             lcd_cmd(0x01);
           LIGHT = 0;  
        }  
   }
   void ON_MODE ()
    {
              
              lcd_cmd(0x83);
           lcd_string ("LIGHT ON",8);
     LIGHT  = 1;  
        
        
    }
void main(void) {
    TRISB = 0x00;  // Port B output
    TRISC = 0x00;   // Port C output
    TRISD = 0xFF;    // Port D input
lcd_init();

    while (1)
    {       
        if (AUTO == 1)
        {
            AUTO_MODE();
        }
        
        if (ON ==1)
            
        {
           ON_MODE();      
        }
         else 
        {
           LIGHT = 0;  
        }
          if (OFF ==1)
            
        {
           lcd_cmd(0x83);
           lcd_string ("LIGHT OFF",9);  
        }
}
}
  